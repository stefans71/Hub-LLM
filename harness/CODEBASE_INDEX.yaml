# =============================================================================
# HUB-LLM CODEBASE INDEX
# =============================================================================
# Single source of truth for codebase structure.
# Director reads this INSTEAD of scanning source code.
# Lead Engineer UPDATES this after every task that changes code.
# Code Researcher agent writes entries directly into this file.
#
# Generated by: DOCS-06 task (initial), then maintained by Lead Engineer
# Last full regeneration: [PENDING - run DOCS-06]
# Last partial update: [PENDING]
# =============================================================================

meta:
  repo: /root/dev/Hub-LLM
  branch: feature/harness-v2
  stack: "FastAPI (Python) + React (Vite) + SQLite"
  frontend_port: 5173
  backend_port: 8000
  total_components: 0       # update after DOCS-06
  total_backend_routers: 12
  total_localStorage_keys: 0  # update after DOCS-06
  last_full_index_session: 0  # update after DOCS-06
  last_partial_update_session: 0

# ============================================================================
# FRONTEND — Pages (frontend/src/pages/)
# ============================================================================
frontend_pages:
  # DOCS-06 will populate. Format:
  #
  # PageName.jsx:
  #   path: frontend/src/pages/PageName.jsx
  #   lines: [N]
  #   purpose: "[one sentence]"
  #   key_state:
  #     - {name: varName, type: type, line: [N], drives: "[what]"}
  #   children: [Component.jsx]
  #   routes_to: [OtherPage.jsx]
  #   localStorage_keys:
  #     - {key: key_name, line: [N], direction: read|write|both}
  #   last_verified_session: [N]

# ============================================================================
# FRONTEND — Components (frontend/src/components/)
# ============================================================================
frontend_components:
  # DOCS-06 will populate. Format:
  #
  # ComponentName.jsx:
  #   path: frontend/src/components/ComponentName.jsx
  #   lines: [N]
  #   purpose: "[one sentence]"
  #   key_state:
  #     - {name: varName, type: type, line: [N], drives: "[what]"}
  #   props_from: Parent.jsx
  #   children: [Child.jsx]
  #   api_calls:
  #     - {endpoint: "/api/path", method: POST, line: [N]}
  #   localStorage_keys:
  #     - {key: key_name, line: [N], direction: read|write|both}
  #   imported_by: [File.jsx]
  #   known_issues:
  #     - {desc: "[issue]", sessions: [N], status: fixed|open}
  #   last_verified_session: [N]

# ============================================================================
# FRONTEND — Contexts (frontend/src/contexts/)
# ============================================================================
frontend_contexts:
  # AuthContext.jsx etc. DOCS-06 will populate.

# ============================================================================
# BACKEND — Routers (backend/routers/)
# ============================================================================
backend_routers:
  # DOCS-06 will populate. Format:
  #
  # router_name.py:
  #   path: backend/routers/router_name.py
  #   lines: [N]
  #   endpoints:
  #     - {method: POST, path: "/api/...", purpose: "[what]", line: [N]}
  #   called_by_frontend: [Component.jsx]
  #   db_tables: [table1]
  #   known_issues:
  #     - {desc: "[issue]", sessions: [N]}
  #   last_verified_session: [N]

# ============================================================================
# BACKEND — Services (backend/services/)
# ============================================================================
backend_services:
  # vps_connection.py etc. DOCS-06 will populate.

# ============================================================================
# DATABASE SCHEMA
# ============================================================================
database:
  # Run: sqlite3 backend/hubllm.db '.schema'
  # DOCS-06 will populate.

# ============================================================================
# DATA FLOW — localStorage
# ============================================================================
data_flow:
  localStorage_keys:
    # DOCS-06 will populate. Format:
    #
    # key_name:
    #   set_by: [Component.jsx, Setup.jsx]
    #   read_by: [Workspace.jsx, backend/routers/servers.py]
    #   sync_direction: "frontend → backend on page load"
    #   bugs:
    #     - {desc: "[issue]", sessions: [N]}

# ============================================================================
# CROSS-CUTTING — Recurring Bug Patterns
# ============================================================================
recurring_bugs:
  - id: 1
    desc: "localStorage vs backend sync — backend loses data on restart"
    sessions: [43, 47]
    affected_files: [ServerManager.jsx, servers.py]
    status: known_pattern
  - id: 2
    desc: "claudeCodeStatus timing — renders before async check"
    sessions: [81, 82]
    affected_files: [Chat.jsx, WorkspaceTopBar.jsx]
    status: fixed
  - id: 3
    desc: "CSS overflow clips absolutely positioned dropdowns"
    sessions: [46]
    affected_files: []
    status: known_pattern
  - id: 4
    desc: "Stale closures in useEffect — use setState(prev => ...)"
    sessions: []
    affected_files: []
    status: known_pattern
  - id: 5
    desc: "fitAddon.fit() must run AFTER container is visible"
    sessions: []
    affected_files: [MultiTerminal.jsx, WorkspaceTerminal.jsx]
    status: known_pattern
