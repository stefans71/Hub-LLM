{
  "version": "5.2",
  "updated": "2026-01-25",
  "session_docs": ["CLAUDE.md", "harness/feature_queue.json"],
  "vision": {
    "summary": "Chat-focused workspace with LLM-Dev panel for dev tools",
    "main_area": "Chat ONLY (no tabs)",
    "llm_dev_panel": {
      "tabs": ["Terminal", "Editor", "Docker", "Logs", "Project Context"],
      "terminal": "Multi-terminal split panes with color coding"
    },
    "left_sidebar": {
      "status_dots": "‚óè green=connected, ‚óã gray=disconnected, üî¥ red=error",
      "project_menu": "3-dot menu (Rename, Settings, Disconnect, Delete)",
      "truncation": "Names truncate with hover tooltip"
    }
  },
  "queue": [
    {
      "id": "CLAUDE-02-REWORK",
      "name": "Chat Area as Terminal Mirror for Claude Code",
      "size": "L",
      "priority": 1,
      "status": "pending",
      "description": "Replace one-shot `claude -p` approach with live terminal session. Chat area becomes a styled terminal view into VPS where Claude Code runs. Zero processing on our side - just display.",
      "current": "CLAUDE-02 runs `claude -p 'prompt'` one-shot commands via SSH. No conversation context, no streaming, no interactive features.",
      "context": "When user selects Anthropic model + has VPS with Claude Code authenticated, the chat should connect to a live Claude Code session on their VPS, not run one-shot commands.",
      "approach": [
        "PHASE 1 - Terminal in Chat Area:",
        "- When Anthropic model selected + Claude Code ready, chat area shows/becomes terminal",
        "- Terminal connects to VPS via existing SSH WebSocket",
        "- Auto-run `claude` command on connect to start Claude Code session",
        "- User types in chat input ‚Üí sends to terminal stdin",
        "- Terminal output displays in chat area",
        "- This is literally xterm.js in the chat area - we already have this working in LLM-Dev",
        "",
        "PHASE 2 - Pretty Rendering (same terminal, styled output):",
        "- Detect Claude Code output patterns (prompts, responses, thinking blocks)",
        "- Render in chat bubble style instead of raw terminal",
        "- User messages ‚Üí right-aligned bubbles",
        "- Claude responses ‚Üí left-aligned bubbles with avatar",
        "- Still zero processing - just CSS/display formatting of terminal output",
        "- Raw terminal view available in LLM-Dev panel below"
      ],
      "investigation": [
        "Before implementing, investigate:",
        "1. What are Claude Code's output patterns? (How to detect user vs assistant text)",
        "2. Does Claude Code use ANSI codes or special markers we can parse?",
        "3. Can we intercept xterm.js output stream for pattern matching?",
        "4. How does `claude --resume` work - can we list/select conversations?"
      ],
      "change": [
        "Remove or deprecate the `claude -p` one-shot approach from CLAUDE-02",
        "Create terminal-based chat component for Anthropic model mode",
        "Wire chat input to terminal stdin when in Claude Code mode",
        "Add output pattern detection for chat bubble rendering",
        "Keep raw terminal visible in LLM-Dev panel as fallback/debug view"
      ],
      "test": "Select Anthropic model with VPS + Claude Code ‚Üí chat area shows Claude Code session ‚Üí type message ‚Üí Claude responds ‚Üí shows in chat bubbles ‚Üí same conversation visible in LLM-Dev terminal"
    },
    {
      "id": "SETTINGS-01",
      "name": "Wire Settings Connected Status to Real Detection",
      "size": "S",
      "priority": 2,
      "status": "pending",
      "description": "Settings page shows mock 'Anthropic connected' - wire to real Claude Code detection",
      "current": "Settings shows hardcoded mock status for Anthropic connection",
      "change": [
        "In Settings, show real connection status for:",
        "- OpenRouter: Check if API key exists in localStorage and display status",
        "- Anthropic: Check if any saved VPS has Claude Code authenticated",
        "- VPS list: Show which VPSes have Claude Code installed/authenticated",
        "Reuse detection logic pattern from CLAUDE-01 (run which claude and claude --version)",
        "Note: Settings.jsx is very large - use grep/offset to read specific sections"
      ],
      "test": "Settings shows real status - Anthropic only 'connected' if Claude Code detected on a VPS"
    },
    {
      "id": "MODEL-04",
      "name": "Dynamic Model List from OpenRouter API",
      "size": "M",
      "priority": 2,
      "status": "pending",
      "description": "Replace hardcoded MODEL_LIST with live data from OpenRouter public API",
      "current": "Model selector uses hardcoded MODEL_LIST with ~16 models",
      "change": [
        "Fetch models from https://openrouter.ai/api/v1/models (public, no auth required)",
        "Cache results in localStorage with timestamp (refresh daily or on demand)",
        "Show ALL models in selector, even without API key",
        "Without key: models greyed out with 'Add OpenRouter key' message",
        "With key: all OpenRouter models enabled",
        "Keep Anthropic models special case - show 'Pro Subscription' if Claude Code detected",
        "Group models by provider (OpenAI, Anthropic, Meta, Google, etc.)",
        "Update search to filter across full model list",
        "Handle API fetch errors gracefully - fall back to cached or minimal default list"
      ],
      "test": "No API key ‚Üí see full model list greyed out. Add key ‚Üí all enabled. Search 'llama' ‚Üí shows all Llama variants from OpenRouter."
    },
    {
      "id": "CLAUDE-03",
      "name": "Claude Resume Conversation Support",
      "size": "M",
      "priority": 3,
      "status": "pending",
      "description": "Support resuming previous Claude Code conversations",
      "current": "Each chat session starts fresh, no history",
      "change": [
        "Add 'Resume conversation' option in chat header or menu",
        "Run `claude --resume` on VPS and capture conversation list",
        "Show conversation picker modal",
        "User selects conversation ‚Üí continue in that context",
        "Store last conversation ID per project for quick resume"
      ],
      "test": "Have existing Claude conversation on VPS ‚Üí Resume ‚Üí continue where left off."
    }
  ],
  "completed": [
    {"id": "ONBOARD-01", "name": "Setup Wizard Skeleton", "completed": "2026-01-25"},
    {"id": "MODEL-03", "name": "Billing Switch Warning Popup", "completed": "2026-01-25"},
    {"id": "MODEL-02", "name": "Billing Source Detection and Display", "completed": "2026-01-25"},
    {"id": "CLAUDE-02", "name": "Route Chat to Claude Code on VPS (one-shot approach - needs rework)", "completed": "2026-01-25"},
    {"id": "MODEL-01", "name": "Per-Project Model Persistence", "completed": "2026-01-25"},
    {"id": "CLAUDE-01", "name": "Detect Claude Code on VPS", "completed": "2026-01-25"},
    {"id": "AUTH-01", "name": "Password Validation Rules", "completed": "2026-01-25"},
    {"id": "CLEANUP-03", "name": "Fix Config Mismatch - Standardize on SQLite + Port 8000", "completed": "2026-01-25"},
    {"id": "FEAT-08", "name": "Chat File Drop and Paste", "completed": "2026-01-25"},
    {"id": "BUG-16", "name": "Terminal Pane Can't Resize Smaller", "completed": "2026-01-25"},
    {"id": "BUG-15", "name": "Terminal Connection Drops on Panel Toggle", "completed": "2026-01-25"},
    {"id": "FEAT-09", "name": "Multi-Terminal Split Panes with Color Coding", "completed": "2026-01-25"},
    {"id": "BUG-14", "name": "Editor Tab Not Loading Selected File", "completed": "2026-01-25"},
    {"id": "BUG-13", "name": "TERMINALS Sidebar Not Visible", "completed": "2026-01-25"},
    {"id": "BUG-12", "name": "xterm-screen Width Calculation", "completed": "2026-01-25"},
    {"id": "FEAT-07", "name": "Multiple Terminal Tabs", "completed": "2026-01-25"},
    {"id": "BUG-11", "name": "LLM-Dev Tabs Don't Switch Content", "completed": "2026-01-25"},
    {"id": "BUG-10", "name": "Terminal Content Cutoff", "completed": "2026-01-25"},
    {"id": "FEAT-04", "name": "Terminal Opens in Project Directory", "completed": "2026-01-25"},
    {"id": "FEAT-03", "name": "Remove Explorer from LLM-Dev Panel", "completed": "2026-01-25"},
    {"id": "FEAT-06", "name": "LLM-Dev Editor Tab", "completed": "2026-01-25"},
    {"id": "UI-06", "name": "Delete Confirmation Modal", "completed": "2026-01-25"},
    {"id": "UI-05", "name": "Project 3-Dot Menu", "completed": "2026-01-25"},
    {"id": "UI-04", "name": "Project Name Truncation", "completed": "2026-01-25"},
    {"id": "UI-03", "name": "Project Status Dots", "completed": "2026-01-25"},
    {"id": "UI-02", "name": "Remove Servers/Codespaces Tabs", "completed": "2026-01-25"},
    {"id": "UI-01", "name": "Simplify Top Bar", "completed": "2026-01-25"}
  ]
}
